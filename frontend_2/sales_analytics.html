<!DOCTYPE html>
<html>
<head>
  <title>Sales Analysis</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Overall Sales Analysis</h2>
  <canvas id="overallChart" width="400" height="200"></canvas>
  <h3>Forecast (Next 7 Days)</h3>
  <canvas id="forecastChart" width="400" height="200"></canvas>

  <script>
    async function fetchOverallSales() {
      const resp = await fetch("http://localhost:8000/orders/sales/overall");
      const data = await resp.json();

      const labels = data.map(d => d.day);
      const values = data.map(d => d.total_sales);

      new Chart(document.getElementById("overallChart"), {
        type: 'bar',
        data: { labels, datasets: [{ label: 'Total Sales', data: values, backgroundColor: '#48C9B0' }] }
      });
    }

    async function fetchForecast() {
      const resp = await fetch("http://localhost:8000/orders/sales/forecast");
      const data = await resp.json();

      const labels = data.forecast.map(d => d.ds);
      const values = data.forecast.map(d => d.yhat);

      new Chart(document.getElementById("forecastChart"), {
        type: 'line',
        data: { labels, datasets: [{ label: 'Forecast Sales', data: values, borderColor: '#6A5ACD', fill: false }] }
      });
    }

    fetchOverallSales();
    fetchForecast();
  </script>
</body>
</html>
